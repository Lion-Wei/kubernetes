## etcd学习

#### 基本原理



##### 日志同步

这里描述的日志是etcd对数据的操作日志，要求etcd不同节点操作日志已相同的顺序保存相同的命令，达到不同节点最终状态一样的效果。



**共识算法**

**raft协议**保证系统特性：

- 选举安全
- 增量式日志
- 日志一致性
- 日志完整性
- 状态机安全性：同一个index日志内容必须一样



**各种消息状态**

- commit
- apply到状态机
- 持久化



#### 涉及技术

- raft
  - 共识算法（其他比如Paxos）
- 嵌入式键值存储数据库 [bolt](https://github.com/boltdb/bolt)
- mvcc多版本访问控制



#### 源码走读



#### 疑问

- 选举过程中的读写操作怎么完成

  没有leader，不允许任何数据更新操作，**读应该可以。**

- 为什么选举超时计数值要是随机值

  避免不同的flower同时超时触发选举

